<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog • CausalQueries</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CausalQueries</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a-getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/b-plotting.html">Plotting models</a></li>
    <li><a class="dropdown-item" href="../articles/c-front-door.html">Through the front door</a></li>
    <li><a class="dropdown-item" href="../articles/d-inspecting-posteriors.html">Inspecting posteriors</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/integrated-inferences/CausalQueries/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-news">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Changelog</h1>
      <small>Source: <a href="https://github.com/integrated-inferences/CausalQueries/blob/HEAD/NEWS.md" class="external-link"><code>NEWS.md</code></a></small>
    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.1.1" id="causalqueries-111">CausalQueries 1.1.1<a class="anchor" aria-label="anchor" href="#causalqueries-111"></a></h2><p class="text-muted">CRAN release: 2024-04-26</p>
<p>This is a patch release fixing a bug in the <code><a href="../reference/print.model_query.html">print.model_query()</a></code> S3 method that occurred when querying models using <code>paramters</code>.</p>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.1.0" id="causalqueries-110">CausalQueries 1.1.0<a class="anchor" aria-label="anchor" href="#causalqueries-110"></a></h2><p class="text-muted">CRAN release: 2024-04-10</p>
<div class="section level4">
<h4 id="non-backwards-compatible-changes-1-1-0">Non Backwards Compatible Changes<a class="anchor" aria-label="anchor" href="#non-backwards-compatible-changes-1-1-0"></a></h4>
<p>Accessing <code>causal-model</code> objects via <code>get_</code> methods e.g. <code><a href="../reference/get_nodal_types.html">get_nodal_types()</a></code>, <code>get_parameters</code> is no longer supported. Objects may now be accessed via a unified syntax through the <code><a href="../reference/inspect.html">inspect()</a></code> function (see New Functionality). The following functions are no longer exported:</p>
<ul><li><code><a href="../reference/get_causal_types.html">get_causal_types()</a></code></li>
<li><code><a href="../reference/get_nodal_types.html">get_nodal_types()</a></code></li>
<li><code><a href="../reference/get_all_data_types.html">get_all_data_types()</a></code></li>
<li><code><a href="../reference/get_event_probabilities.html">get_event_probabilities()</a></code></li>
<li><code><a href="../reference/get_ambiguities_matrix.html">get_ambiguities_matrix()</a></code></li>
<li><code><a href="../reference/parameter_setting.html">get_parameters()</a></code></li>
<li><code><a href="../reference/get_parameter_names.html">get_parameter_names()</a></code></li>
<li><code><a href="../reference/get_parmap.html">get_parmap()</a></code></li>
<li><code><a href="../reference/get_parameter_matrix.html">get_parameter_matrix()</a></code></li>
<li><code><a href="../reference/prior_setting.html">get_priors()</a></code></li>
<li><code><a href="../reference/get_param_dist.html">get_param_dist()</a></code></li>
<li><code><a href="../reference/get_type_prob_multiple.html">get_type_prob_multiple()</a></code></li>
</ul></div>
<div class="section level4">
<h4 id="new-functionality-1-1-0">New Functionality<a class="anchor" aria-label="anchor" href="#new-functionality-1-1-0"></a></h4>
<div class="section level5">
<h5 id="id_1-unified-object-access-syntax-via-inspect-1-1-0">1. unified object access syntax via <code>inspect()</code>
<a class="anchor" aria-label="anchor" href="#id_1-unified-object-access-syntax-via-inspect-1-1-0"></a></h5>
<p><code>causal-model</code> objects can now be accessed via <code><a href="../reference/inspect.html">inspect()</a></code> like so:</p>
<pre><code><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"parameters_df"</span><span class="op">)</span></span></code></pre>
<p>See documentation for an exhaustive list of accessible objects. <code>causal-model</code> objects now additionally come with dedicated <code>print</code> methods returning short informative summaries of the given object.</p>
</div>
<div class="section level5">
<h5 id="id_2-model-diagnostics-1-1-0">2. model diagnostics<a class="anchor" aria-label="anchor" href="#id_2-model-diagnostics-1-1-0"></a></h5>
<p>A summary of parameter values and convergence information produced by the <code><a href="../reference/update_model.html">update_model()</a></code> <code>Stan</code> model can now be accessed via:</p>
<pre><code><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"stan_summary"</span><span class="op">)</span></span></code></pre>
<p>Advanced model diagnostics on raw <code>Stan</code> output via external packages is possible by saving the <code>stan_fit</code> object when updating. This is facilitated via the <code>keep_fit</code> option in <code><a href="../reference/update_model.html">update_model()</a></code>:</p>
<pre><code><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_model.html">make_model</a></span><span class="op">(</span><span class="st">"X -&gt; Y"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/update_model.html">update_model</a></span><span class="op">(</span><span class="va">data</span>, keep_fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="st">"stanfit"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.0.2" id="causalqueries-102">CausalQueries 1.0.2<a class="anchor" aria-label="anchor" href="#causalqueries-102"></a></h2><p class="text-muted">CRAN release: 2024-01-15</p>
<div class="section level4">
<h4 id="bug-fixes-1-0-2">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-0-2"></a></h4>
<div class="section level5">
<h5 id="id_1-passing-nodal_types-to-make_model-now-implements-correct-error-handling-1-0-2">1. passing <code>nodal_types</code> to <code>make_model()</code> now implements correct error handling<a class="anchor" aria-label="anchor" href="#id_1-passing-nodal_types-to-make_model-now-implements-correct-error-handling-1-0-2"></a></h5>
<p>Previously this <code>make_model("X -&gt; Y" , nodal_types = list(Y = c("0", "1")))</code> was permissible leading to setting <code>nodal_types</code>:</p>
<pre><code>$X
NULL

$Y
[1] "0" "1"</code></pre>
<p>This led to undefined behavior and unhelpful downstream error messages. When passing <code>nodal_types</code> to <code><a href="../reference/make_model.html">make_model()</a></code> users are now forced to specify a set of <code>nodal_types</code> on each node.</p>
</div>
<div class="section level5">
<h5 id="id_2-query_distribution-are-no-longer-overwrites-type-distribution-internally-1-0-2">2. <code>query_distribution()</code> are no longer overwrites type distribution internally<a class="anchor" aria-label="anchor" href="#id_2-query_distribution-are-no-longer-overwrites-type-distribution-internally-1-0-2"></a></h5>
</div>
<div class="section level5">
<h5 id="id_3-node-naming-checks-are-operational-in-make_model-1-0-2">3. node naming checks are operational in <code>make_model()</code>
<a class="anchor" aria-label="anchor" href="#id_3-node-naming-checks-are-operational-in-make_model-1-0-2"></a></h5>
<p>Previously hyphenated names would not throw an error and be corrupted silently through the conversion of model definition strings into <code>dagitty</code> objects.</p>
<pre><code>make_model("institutions -&gt; political-inequality")

Statement:
[1] "institutions -&gt; political-inequality"

DAG:
        parent  children
1 institutions political</code></pre>
<p>Checks for correct variable naming are now reinstated.</p>
</div>
</div>
<div class="section level4">
<h4 id="improvements-1-0-2">Improvements<a class="anchor" aria-label="anchor" href="#improvements-1-0-2"></a></h4>
<div class="section level5">
<h5 id="id_1-type-safety-1-0-2">1. type safety<a class="anchor" aria-label="anchor" href="#id_1-type-safety-1-0-2"></a></h5>
<p>Calls to <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply()</a></code> have ben replaced with <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply()</a></code> wherever possible to enforce type safety.</p>
</div>
<div class="section level5">
<h5 id="id_2-range-based-looping-1-0-2">2. range based looping<a class="anchor" aria-label="anchor" href="#id_2-range-based-looping-1-0-2"></a></h5>
<p>Looping via index has been replaced by range based looping wherever possible to guard against 0 length exceptions.</p>
</div>
<div class="section level5">
<h5 id="id_3-goodpracticegp-1-0-2">3. <code>goodpractice::gp()</code>
<a class="anchor" aria-label="anchor" href="#id_3-goodpracticegp-1-0-2"></a></h5>
<p><code>goodpractice</code> code improvements have been implemented.</p>
</div>
</div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.0.0" id="causalqueries-100">CausalQueries 1.0.0<a class="anchor" aria-label="anchor" href="#causalqueries-100"></a></h2><p class="text-muted">CRAN release: 2023-10-13</p>
<div class="section level4">
<h4 id="non-backwards-compatible-changes-1-0-0">Non Backwards Compatible Changes<a class="anchor" aria-label="anchor" href="#non-backwards-compatible-changes-1-0-0"></a></h4>
<p><code><a href="../reference/query_distribution.html">query_distribution()</a></code> now supports the use of multiple queries in one function call and thus returns a <code>DataFrame</code> of distribution draws instead of a single numeric vector.</p>
</div>
<div class="section level4">
<h4 id="new-functionality-1-0-0">New Functionality<a class="anchor" aria-label="anchor" href="#new-functionality-1-0-0"></a></h4>
<div class="section level5">
<h5 id="querying-1-0-0">Querying<a class="anchor" aria-label="anchor" href="#querying-1-0-0"></a></h5>
<p><code><a href="../reference/query_distribution.html">query_distribution()</a></code>: now supports the specification of multiple queries and givens to be evaluated on a single model in one function call.</p>
<pre><code><span> <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_model.html">make_model</a></span><span class="op">(</span><span class="st">"X -&gt; Y"</span><span class="op">)</span></span>
<span></span>
<span> <span class="fu"><a href="../reference/query_distribution.html">query_distribution</a></span><span class="op">(</span><span class="va">model</span>,</span>
<span>   query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"(Y[X=1] &gt; Y[X=0])"</span>, <span class="st">"(Y[X=1] &lt; Y[X=0])"</span><span class="op">)</span>,</span>
<span>   given <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Y==1"</span>, <span class="st">"(Y[X=1] &lt;= Y[X=0])"</span><span class="op">)</span>,</span>
<span>   using <span class="op">=</span> <span class="st">"priors"</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p><code><a href="../reference/query_model.html">query_model()</a></code>: now supports the specification of multiple models to evaluate a set of queries on in one function call.</p>
<pre><code><span> <span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  M1 <span class="op">=</span> <span class="fu"><a href="../reference/make_model.html">make_model</a></span><span class="op">(</span><span class="st">"X -&gt; Y"</span><span class="op">)</span>,</span>
<span>  M2 <span class="op">=</span> <span class="fu"><a href="../reference/make_model.html">make_model</a></span><span class="op">(</span><span class="st">"X -&gt; Y"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/set_restrictions.html">set_restrictions</a></span><span class="op">(</span><span class="st">"Y[X=1] &lt; Y[X=0]"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span> <span class="fu"><a href="../reference/query_model.html">query_model</a></span><span class="op">(</span></span>
<span>  <span class="va">models</span>,</span>
<span>  query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ATE <span class="op">=</span> <span class="st">"Y[X=1] - Y[X=0]"</span>, Share_positive <span class="op">=</span> <span class="st">"Y[X=1] &gt; Y[X=0]"</span><span class="op">)</span>,</span>
<span>  given <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,  <span class="st">"Y==1 &amp; X==1"</span><span class="op">)</span>,</span>
<span>  using <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parameters"</span>, <span class="st">"priors"</span><span class="op">)</span>,</span>
<span>  expand_grid <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span> <span class="fu"><a href="../reference/query_model.html">query_model</a></span><span class="op">(</span></span>
<span>  <span class="va">models</span>,</span>
<span>  query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ATE <span class="op">=</span> <span class="st">"Y[X=1] - Y[X=0]"</span>, Share_positive <span class="op">=</span> <span class="st">"Y[X=1] &gt; Y[X=0]"</span><span class="op">)</span>,</span>
<span>  given <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,  <span class="st">"Y==1 &amp; X==1"</span><span class="op">)</span>,</span>
<span>  using <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parameters"</span>, <span class="st">"priors"</span><span class="op">)</span>,</span>
<span>  expand_grid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
<p>This eliminates the need for redundant function calls when querying models and substantially improves computation time as computationally expensive function calls to produce data structures required for querying are now reduced to a minimum via redundancy elimination and caching.</p>
</div>
<div class="section level5">
<h5 id="realising-outcomes-and-interpreting-nodal-causal-types-1-0-0">Realising Outcomes and Interpreting Nodal-/Causal-Types<a class="anchor" aria-label="anchor" href="#realising-outcomes-and-interpreting-nodal-causal-types-1-0-0"></a></h5>
<p><code><a href="../reference/realise_outcomes.html">realise_outcomes()</a></code>: specifying the <code>node</code> option now produces a <code>DataFrame</code> detailing how the specified node responds to its parents in the presence or absence of do operations. This produces a reduced form of the usual <code><a href="../reference/realise_outcomes.html">realise_outcomes()</a></code> output detailing all causal-types; and aids in the interpretation of both nodal- and causal-types. This update resolves previous bugs and errors relating to specification of nodes with multiple parents in the <code>node</code> option.</p>
<pre><code><span> <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_model.html">make_model</a></span><span class="op">(</span><span class="st">"X1 -&gt; M -&gt; Y -&gt; Z; X2 -&gt; Y"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/realise_outcomes.html">realise_outcomes</a></span><span class="op">(</span>dos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>M <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, node <span class="op">=</span> <span class="st">"Y"</span><span class="op">)</span> </span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="bug-fixes-1-0-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-0-0"></a></h4>
<div class="section level5">
<h5 id="id_1-setting-parameters-and-priors-1-0-0">1. Setting Parameters and Priors<a class="anchor" aria-label="anchor" href="#id_1-setting-parameters-and-priors-1-0-0"></a></h5>
<p>Previously <code><a href="../reference/parameter_setting.html">set_parameters()</a></code> and <code><a href="../reference/prior_setting.html">set_priors()</a></code> would default applying changes in the order in which parameters appeared in the <code>parameters_df</code> <code>DataFrame</code>; regardless of the order in which changes were specified in the aforementioned functions. Calling:</p>
<pre><code><span> <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_model.html">make_model</a></span><span class="op">(</span><span class="st">"X -&gt; Y"</span><span class="op">)</span></span>
<span> <span class="fu"><a href="../reference/prior_setting.html">set_priors</a></span><span class="op">(</span><span class="va">model</span>, alphas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, nodal_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10"</span>,<span class="fl">00</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>would results in the following <code>parameters_df</code>.</p>
<pre><code>  param_names node    gen param_set nodal_type given param_value priors
  &lt;chr&gt;       &lt;chr&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;
1 X.0         X         1 X         0          ""           0.5       1
2 X.1         X         1 X         1          ""           0.5       1
3 Y.00        Y         2 Y         00         ""           0.25      3
4 Y.10        Y         2 Y         10         ""           0.25      4
5 Y.01        Y         2 Y         01         ""           0.25      1
6 Y.11        Y         2 Y         11         ""           0.25      1</code></pre>
<p>Now changes to parameters values get applied in the order specified in the function call; resulting in the following <code>parameters_df</code> for the above example:</p>
<pre><code>  param_names node    gen param_set nodal_type given param_value priors
  &lt;chr&gt;       &lt;chr&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;
1 X.0         X         1 X         0          ""           0.5       1
2 X.1         X         1 X         1          ""           0.5       1
3 Y.00        Y         2 Y         00         ""           0.25      4
4 Y.10        Y         2 Y         10         ""           0.25      3
5 Y.01        Y         2 Y         01         ""           0.25      1
6 Y.11        Y         2 Y         11         ""           0.25      1</code></pre>
<p>Additionally we have implemented helpful warnings for when instructions identifying parameters to be updated are under specified. This is particularly useful when setting priors or parameters on models with confounding as changes may inadvertently be applied across <code>param_sets</code>.</p>
</div>
<div class="section level5">
<h5 id="id_2-updating-with-censored-types-1-0-0">2. Updating with Censored Types<a class="anchor" aria-label="anchor" href="#id_2-updating-with-censored-types-1-0-0"></a></h5>
<p>Previously updating models with censored types would fail as 0s in the <code>w</code> vector induced by censoring would evaluate to -Inf as the <code>Stan</code> MCMC algorithm began sampling from the posterior of the multinational distribution. We resolved this issue by pruning the <code>w</code> vector when the multinomial is run. This preserves the true <code>w</code> vector (event probabilities without censoring) while still updating with the censored data-</p>
</div>
<div class="section level5">
<h5 id="id_3-setting-restrictions-with-wild-cards-1-0-0">3. Setting Restrictions with Wild Cards<a class="anchor" aria-label="anchor" href="#id_3-setting-restrictions-with-wild-cards-1-0-0"></a></h5>
<p>Previously <code>wildcards</code> in <code><a href="../reference/set_restrictions.html">set_restrictions()</a></code> were erroneously interpreted as valid nodal types, leading to errors and undefined behavior. Proper unpacking and mapping of <code>wildcards</code> to existing nodal types has been restored.</p>
</div>
<div class="section level5">
<h5 id="id_4-checks-for-misspecified-queries-1-0-0">4. Checks for Misspecified Queries<a class="anchor" aria-label="anchor" href="#id_4-checks-for-misspecified-queries-1-0-0"></a></h5>
<p>Previously misspecifications in queries like <code>Y[X==1]=1</code> would lead to undefined behavior when mapping queries to nodal or causal types. We now correct misspecified queries internally and warn about the misspecification. For example; running:</p>
<pre><code><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">CausalQueries</span><span class="fu">::</span><span class="fu"><a href="../reference/make_model.html">make_model</a></span><span class="op">(</span><span class="st">"X -&gt; Y"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_query_types.html">get_query_types</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"Y[X=1]=1"</span><span class="op">)</span></span></code></pre>
<p>now produces</p>
<pre><code>Causal types satisfying query's condition(s)

 query =  Y[X=1]==1

X0.Y01  X1.Y01
X0.Y11  X1.Y11


 Number of causal types that meet condition(s) =  4
 Total number of causal types in model =  8
Warning message:
In check_query(query) :
  statements to the effect that the realization of a node should equal some value should be specified with `==` not `=`.
  The query has been changed accordingly: Y[X=1]==1
</code></pre>
</div>
<div class="section level5">
<h5 id="id_5-allowing-overwriting-of-a-parameter-matrix-1-0-0">5. Allowing overwriting of a Parameter Matrix<a class="anchor" aria-label="anchor" href="#id_5-allowing-overwriting-of-a-parameter-matrix-1-0-0"></a></h5>
<p>Previously a parameter matrix <code>P</code> that was attached to a <code>causal_model</code> object could not be overwritten. Overwrites are now possible.</p>
</div>
</div>
<div class="section level4">
<h4 id="improvements-1-0-0">Improvements<a class="anchor" aria-label="anchor" href="#improvements-1-0-0"></a></h4>
<div class="section level5">
<h5 id="id_1-fast-realise_outcomes-1-0-0">1. Fast <code>realise_outcomes()</code>
<a class="anchor" aria-label="anchor" href="#id_1-fast-realise_outcomes-1-0-0"></a></h5>
<p>We achieved a ~100 fold speed gain in the <code><a href="../reference/realise_outcomes.html">realise_outcomes()</a></code> functionality. Nodal types on a given node are generated as the Cartesian product of parent realizations. Consider the meaning of nodal types on a node <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> with 3 parents <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>X</mi><mn>1</mn><mo>,</mo><mi>X</mi><mn>2</mn><mo>,</mo><mi>X</mi><mn>3</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[X1,X2,X3]</annotation></semantics></math>:</p>
<table class="table"><thead><tr class="header"><th>X1</th>
<th>X2</th>
<th>X3</th>
</tr></thead><tbody><tr class="odd"><td>0</td>
<td>0</td>
<td>0</td>
</tr><tr class="even"><td>1</td>
<td>0</td>
<td>0</td>
</tr><tr class="odd"><td>0</td>
<td>1</td>
<td>0</td>
</tr><tr class="even"><td>1</td>
<td>1</td>
<td>0</td>
</tr><tr class="odd"><td>0</td>
<td>0</td>
<td>1</td>
</tr><tr class="even"><td>1</td>
<td>0</td>
<td>1</td>
</tr><tr class="odd"><td>0</td>
<td>1</td>
<td>1</td>
</tr><tr class="even"><td>1</td>
<td>1</td>
<td>1</td>
</tr></tbody></table><p>Each row in the above <code>DataFrame</code> corresponds to a digit in <code>Y's</code> nodal types. The first digit of each nodal type of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> (see first row above), corresponds to the realization of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> when <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mn>1</mn><mo>=</mo><mn>0</mn><mo>,</mo><mi>X</mi><mn>2</mn><mo>=</mo><mn>0</mn><mo>,</mo><mi>X</mi><mn>3</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X1 = 0, X2 = 0, X3 = 0</annotation></semantics></math>. The fourth digit of each nodal type of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> (see fourth row above), corresponds to the realization of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> when <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mn>1</mn><mo>=</mo><mn>1</mn><mo>,</mo><mi>X</mi><mn>2</mn><mo>=</mo><mn>1</mn><mo>,</mo><mi>X</mi><mn>3</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X1 = 1, X2 = 1, X3 = 0</annotation></semantics></math>. Finding the position of the realization value of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> in a nodal type given parent realizations is equivalent to finding the row number in the Cartesian product <code>DataFrame</code>. By definition of the Cartesian product, the number of consecutive 0 or 1 elements in a given column is <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>2</mn><mrow><mi>c</mi><mi>o</mi><mi>l</mi><mi>u</mi><mi>m</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi></mrow></msup><annotation encoding="application/x-tex">2^{columnindex}</annotation></semantics></math>, when indexing columns from 0. Given a set of parent realizations <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math> indexed from 0, the corresponding row in a number in a <code>DataFrame</code> indexed from 0 can thus be computed via: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>o</mi><mi>w</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>R</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>−</mo><mn>1</mn></mrow></munderover><mrow><mo stretchy="true" form="prefix">(</mo><msup><mn>2</mn><mi>i</mi></msup><mo>×</mo><msub><mi>R</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">row = (\sum_{i = 0}^{|R| - 1} (2^{i} \times R_i))</annotation></semantics></math>. We implement a fast <code>C++</code> version of this computing powers of 2 via bit shifting.</p>
</div>
<div class="section level5">
<h5 id="id_2-stan-update-1-0-0">2. <code>Stan</code> update<a class="anchor" aria-label="anchor" href="#id_2-stan-update-1-0-0"></a></h5>
<p>We updated to the new array syntax introduced in <code>Stan</code> <code>v2.33.0</code></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Macartan Humphreys, Till Tietz, Alan Jacobs, Lily Medina, Georgiy Syunyaev.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

